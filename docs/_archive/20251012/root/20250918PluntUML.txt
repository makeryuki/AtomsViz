
▌ PluntUMLで各種設計図を出せる？

> 出力専用の PlantUML ツールは手元にないので画像化まではできませんが、PlantUML 形式のソースなら生成できます。
  設計図（クラス図やシーケンス図など）を用意したい場合、書いてほしい種類・観点（例: クラス間の依存関係、カメラ操作のシー
  ケンスなど）を教えてもらえれば、@startuml … @enduml の形で提供します。
  その内容を PlantUML 対応ツールやサイトでレンダリングしてもらえば利用できるはずです。

▌ 一通りの図をお願い

• Proposed Command
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/diagrams.md' -Value @'
    # PlantUML 図集

    ## クラス図

    "'```plantuml
    @startuml
    skinparam classAttributeIconSize 0

    class AtmosVizAudioProcessor {
      - latestMetrics : SpeakerMetrics[12]
      - metricsLock : SpinLock
      + processBlock(buffer, midi)
      + copyLatestMetrics(dest)
    }

    class SpeakerVisualizerComponent {
      - speakers : DisplaySpeaker[*]
      - cameraPreset : CameraPreset
      - zoomFactor : float
      - cameraDistance : float
      + setCameraPreset(preset)
      + setZoomFactor(value, fromPreset=false)
      + paint(graphics)
      + mouseDrag(event)
      + mouseWheelMove(event, wheel)
    }

    class AtmosVizAudioProcessorEditor {
      - visualizer : SpeakerVisualizerComponent
      - cameraButtons : CameraButtonInfo[*]
      - zoomSlider : Slider
      + setCameraPreset(preset)
      + sliderValueChanged(slider)
    }

    class CameraPreset <<enumeration>> {
      Home
      Inside
      Outside
      Front
      Back
      Left
      Right
      Top
      Bottom
    }

    class SpeakerMetrics {
      + rms : float
      + peak : float
      + bands : FrequencyBands
    }

    AtmosVizAudioProcessor --> SpeakerVisualizerComponent : feeds metrics
    AtmosVizAudioProcessorEditor *-- SpeakerVisualizerComponent
    SpeakerVisualizerComponent --> CameraPreset
    SpeakerVisualizerComponent --> SpeakerMetrics

    @enduml
    ```

    ## シーケンス図 (オーディオ処理と描画更新)

    ```plantuml
    @startuml
    actor User
    participant DAW
    participant "AudioProcessor" as AP
    participant "Shared Metrics" as Store
    participant "SpeakerVisualizer" as SV
    participant "Timer" as TM

    User -> DAW : 再生/音声入力
    DAW -> AP : processBlock(buffer)
    AP -> Store : 更新済みメトリクスを書き込み
    TM -> SV : timerCallback()
    SV -> Store : 最新メトリクスを読み込み
    SV -> SV : paint()
    SV -> User : 可視化を更新表示
    @enduml
    ```

    ## アクティビティ図 (カメラプリセット切替)

    ```plantuml
    @startuml
    start
    :プリセットボタン押下;
    if (Inside?) then (yes)
      :cameraInside = true;
      :yaw/pitch を Home 基準に設定;
      :zoomFactor = insideBase / distance;
    else (no)
      :cameraInside = false;
      :yaw/pitch を外部プリセット値に設定;
      :zoomFactor = outsideMin / distance;
    endif
    :cameraDistance を更新;
    :ズームスライダーに反映;
    :画面を再描画;
    stop
    @enduml
    ```

    ## ステート図 (ズーム挙動)

    ```plantuml
    @startuml
    [*] --> InsideZoom
    InsideZoom --> InsideZoom : ホイール/スライダー
    InsideZoom --> OutsideZoom : Outside プリセット選択
    OutsideZoom --> InsideZoom : Inside/Home プリセット選択
    OutsideZoom --> OutsideZoom : ホイール/スライダー

    state InsideZoom {
      [*] --> FixedDistance
      FixedDistance -> FixedDistance : zoomFactor ↗ => 距離↓
    }

    state OutsideZoom {
    }
    @enduml
    ```


• Ran
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/diagrams.md' -Value @'
    # PlantUML 図集

    ## クラス図

    "'```plantuml
    @startuml
    skinparam classAttributeIconSize 0

    class AtmosVizAudioProcessor {
      - latestMetrics : SpeakerMetrics[12]
      - metricsLock : SpinLock
      + processBlock(buffer, midi)
      + copyLatestMetrics(dest)
    }

    class SpeakerVisualizerComponent {
      - speakers : DisplaySpeaker[*]
      - cameraPreset : CameraPreset
      - zoomFactor : float
      - cameraDistance : float
      + setCameraPreset(preset)
      + setZoomFactor(value, fromPreset=false)
      + paint(graphics)
      + mouseDrag(event)
      + mouseWheelMove(event, wheel)
    }

    class AtmosVizAudioProcessorEditor {
      - visualizer : SpeakerVisualizerComponent
      - cameraButtons : CameraButtonInfo[*]
      - zoomSlider : Slider
      + setCameraPreset(preset)
      + sliderValueChanged(slider)
    }

    class CameraPreset <<enumeration>> {
      Home
      Inside
      Outside
      Front
      Back
      Left
      Right
      Top
      Bottom
    }

    class SpeakerMetrics {
      + rms : float
      + peak : float
      + bands : FrequencyBands
    }

    AtmosVizAudioProcessor --> SpeakerVisualizerComponent : feeds metrics
    AtmosVizAudioProcessorEditor *-- SpeakerVisualizerComponent
    SpeakerVisualizerComponent --> CameraPreset
    SpeakerVisualizerComponent --> SpeakerMetrics

    @enduml
    ```

    ## シーケンス図 (オーディオ処理と描画更新)

    ```plantuml
    @startuml
    actor User
    participant DAW
    participant "AudioProcessor" as AP
    participant "Shared Metrics" as Store
    participant "SpeakerVisualizer" as SV
    participant "Timer" as TM

    User -> DAW : 再生/音声入力
    DAW -> AP : processBlock(buffer)
    AP -> Store : 更新済みメトリクスを書き込み
    TM -> SV : timerCallback()
    SV -> Store : 最新メトリクスを読み込み
    SV -> SV : paint()
    SV -> User : 可視化を更新表示
    @enduml
    ```

    ## アクティビティ図 (カメラプリセット切替)

    ```plantuml
    @startuml
    start
    :プリセットボタン押下;
    if (Inside?) then (yes)
      :cameraInside = true;
      :yaw/pitch を Home 基準に設定;
      :zoomFactor = insideBase / distance;
    else (no)
      :cameraInside = false;
      :yaw/pitch を外部プリセット値に設定;
      :zoomFactor = outsideMin / distance;
    endif
    :cameraDistance を更新;
    :ズームスライダーに反映;
    :画面を再描画;
    stop
    @enduml
    ```

    ## ステート図 (ズーム挙動)

    ```plantuml
    @startuml
    [*] --> InsideZoom
    InsideZoom --> InsideZoom : ホイール/スライダー
    InsideZoom --> OutsideZoom : Outside プリセット選択
    OutsideZoom --> InsideZoom : Inside/Home プリセット選択
    OutsideZoom --> OutsideZoom : ホイール/スライダー

    state InsideZoom {
      [*] --> FixedDistance
      FixedDistance -> FixedDistance : zoomFactor ↗ => 距離↓
    }

    state OutsideZoom {
      [*] --> VariableDistance
      VariableDistance -> VariableDistance : zoomFactor ↘ => 距離↑
    }
    @enduml
    ```

    ## コンポーネント図

    ```plantuml
    @startuml
    rectangle "AtmosViz VST3" {
      component "Audio Processor" as AP
      component "Editor UI" as UI
      component "Speaker Visualizer" as SV
      database "Metrics Store" as MS
    }

    AP --> MS : metrics write
    UI --> SV : embed
    SV --> MS : metrics read
    AP <-- DAW : audio buffer
    UI <-- User : 操作
    @enduml
    ```
    '"'@"

> docs/diagrams.md に PlantUML 形式の図をまとめました（クラス図・シーケンス図・アクティビティ図・ステート図・コンポーネ
  ント図）。必要に応じて PlantUML 対応ツールでレンダリングして利用してください。