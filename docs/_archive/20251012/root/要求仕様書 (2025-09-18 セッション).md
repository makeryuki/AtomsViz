    # 要求仕様書 (2025-09-18 セッション)

    ## 概要
    - プラグイン名: AtmosViz
    - 目的: Dolby Atmos 7.1.4 入力ストリームを 3D 空間上に可視化し、各スピーカーの指向性・出力レベルを即座に把握できるよ
うにする。
    - 対象環境: VST3 対応 DAW (Windows / Visual Studio 2022 ビルド)

    ## 必須要件
    1. **入出力**
       - 入力: 7.1.4 チャンネルレイアウト。
       - 出力: モニタリング専用 (サイレント)。
    2. **スピーカー配置**
       - Dolby 規定の 7.1.4 スピーカー方位・高さをプリセットとして実装。
       - 初期状態 (Home/Inside) はリスニングポジションから正面を向いた状態。
    3. **可視化**
       - 各スピーカーを 3D 空間上に球 + 指向性ローブで描画。
       - RMS レベルに応じてローブの長さ・広がり・色を変化させる。
       - XYZ ギズモを表示して空間方向を示す。
    4. **カメラ操作**
       - プリセットボタン (Home / Inside / Outside / Front / Back / Left / Right / Top / Bottom)。


• Ran
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/requirements.md' -Value @'
    # 要求仕様書 (2025-09-18 セッション)

    ## 概要
    - プラグイン名: AtmosViz
    - 目的: Dolby Atmos 7.1.4 入力ストリームを 3D 空間上に可視化し、各スピーカーの指向性・出力レベルを即座に把握できるよ
        うにする。
    - 対象環境: VST3 対応 DAW (Windows / Visual Studio 2022 ビルド)

    ## 必須要件
    1. **入出力**
       - 入力: 7.1.4 チャンネルレイアウト。
       - 出力: モニタリング専用 (サイレント)。
    2. **スピーカー配置**
       - Dolby 規定の 7.1.4 スピーカー方位・高さをプリセットとして実装。
       - 初期状態 (Home/Inside) はリスニングポジションから正面を向いた状態。
    3. **可視化**
       - 各スピーカーを 3D 空間上に球 + 指向性ローブで描画。
       - RMS レベルに応じてローブの長さ・広がり・色を変化させる。
       - LFE は球のみ、他チャンネルは扇形ローブを描画。
       - ルームワイヤーフレーム: 室内では全実線、室外視点では背面破線と前面実線を使用。
       - XYZ ギズモを表示して空間方向を示す。
    4. **カメラ操作**
       - プリセットボタン (Home / Inside / Outside / Front / Back / Left / Right / Top / Bottom)。
       - Inside: 原点を中心にカメラが回転。Outside: 距離を直接変化させ遠近を表現。
       - Outside 選択時には遠距離から俯瞰できるよう初期距離を自動セット。
       - ボタン表記は Home 状態を基準とした回転方向に対応する。
    5. **ズーム操作**
       - スライダーとマウスホイールで共通ズーム値 (0.001–2.0) を操作。
       - Inside はズーム値が大きいほど近く、Outside はズーム値が小さいほど遠くなる。
    6. **ビルド/配布**
       - Visual Studio 2022 によるビルド。
       - 生成物は "'`Builds/VisualStudio2022/x64/Debug/VST3/AtmosViz.vst3/Contents/x86_64-win/AtmosViz.vst3`。

    ## 非機能要件
    - フレームレート: 60 fps を目標。
    - レイテンシ: 音声処理を阻害しないレベル (軽量解析)。
    - コードは C++17 / JUCE 8.0.1 準拠。

    ## 未解決/次回検討事項
    - パラメータ保存 (ユーザ設定の永続化)。
    - LFE 可視化の表現拡張 (低域帯域の強調など)。
    - 色やローブ形状のテーマ変更機能。
    '"'@"
    Set-Content: Could not find a part of the path 'C:\Users\capi_\codex\docs\requirements.md'.

• Proposed Command
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/requirements.md' -Value @'
    # 要求仕様書 (2025-09-18 セッション)

    ## 概要
    - プラグイン名: AtmosViz
    - 目的: Dolby Atmos 7.1.4 入力ストリームを 3D 空間に可視化し、各スピーカーの指向性・出力レベルを直感的に把握可能に
する。
    - 対象環境: Windows / Visual Studio 2022 (JUCE 8.0.1 ベース)

    ## 機能要件
    1. **入出力構成**
       - 入力: Dolby Atmos 7.1.4 バス。
       - 出力: モニタリング専用のサイレント出力。
    2. **スピーカー配置**
       - Dolby 推奨角度・高さを採用した 12 スピーカー (7.1.4) プリセット。
       - 初期状態 (Home/Inside) はリスニングポジションからセンター/フロント L,R を正面に見る状態。
    3. **3D 可視化**
       - スピーカー位置を球体で表示し、指向性ローブ (扇形) で RMS レベルと帯域バランスを表現。
       - 原点に XYZ ギズモを表示。
    4. **カメラ操作**
       - プリセットボタン (Home/Inside/Outside/Front/Back/Left/Right/Top/Bottom)。


• Ran
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/requirements.md' -Value @'
    # 要求仕様書 (2025-09-18 セッション)

    ## 概要
    - プラグイン名: AtmosViz
    - 目的: Dolby Atmos 7.1.4 入力ストリームを 3D 空間に可視化し、各スピーカーの指向性・出力レベルを直感的に把握可能に
        する。
    - 対象環境: Windows / Visual Studio 2022 (JUCE 8.0.1 ベース)

    ## 機能要件
    1. **入出力構成**
       - 入力: Dolby Atmos 7.1.4 バス。
       - 出力: モニタリング専用のサイレント出力。
    2. **スピーカー配置**
       - Dolby 推奨角度・高さを採用した 12 スピーカー (7.1.4) プリセット。
       - 初期状態 (Home/Inside) はリスニングポジションからセンター/フロント L,R を正面に見る状態。
    3. **3D 可視化**
       - スピーカー位置を球体で表示し、指向性ローブ (扇形) で RMS レベルと帯域バランスを表現。
       - LFE は球のみ表示。
       - ルームワイヤーフレーム: 内部視点では全実線、外部視点では前面実線・背面破線。
       - 原点に XYZ ギズモを表示。
    4. **カメラ操作**
       - プリセットボタン (Home/Inside/Outside/Front/Back/Left/Right/Top/Bottom)。
       - Inside: 原点を中心に回転のみ実施。Outside: 距離を直接変更して俯瞰範囲を広げる。
       - 各プリセットは Home を基準とした回転方向に一致させ、Back/Left/Right で左右が正しく反転するよう調整。
    5. **ズーム/距離制御**
       - 共通ズーム値 (0.001〜2.0) をスライダー・マウスホイールで調整。
       - Inside はズーム値が大きいほど近寄り、Outside はズーム値が小さいほど遠ざかる挙動。
       - Outside 選択時は初期距離を遠方 (約 40 m) に設定。
    6. **ビルド/配置**
       - Visual Studio 2022 でビルドし、生成された "'`AtmosViz.vst3` を `%COMMONPROGRAMFILES%'"\\VST3"'` へコピーして
        使用。

    ## 非機能要件
    - レイテンシ: 音声処理への影響がないこと (軽量解析)。
    - フレームレート: 60 fps を目標。
    - コード規約: C++17 / JUCE のスタイルに準拠。

    ## 今後の検討事項
    - ユーザー設定の永続化 (プリセット保存)。
    - LFE 表現・カラーマッピングの拡張オプション。
    - GUI テーマやローブ形状のカスタマイズ機能。
    '"'@"

• Proposed Command
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/basic_design.md' -Value @'
    # 基本設計書 (AtmosViz)

    ## 1. システム構成
    - ベースフレームワーク: JUCE 8.0.1
    - プロジェクト構成
      - "'`PluginProcessor` : オーディオ処理・解析を担当。
      - `PluginEditor`    : 3D 可視化 UI、カメラ制御、ユーザーインタラクション。
      - `docs/`           : 各種ドキュメント格納先。

    ## 2. データフロー
    1. DAW から 7.1.4 オーディオバッファを受け取る。
    2. `PluginProcessor::processBlock` で各チャンネルの RMS / Peak / FFT を計算し、最新メトリクスを共有メモリ
(`latestMetrics`) に格納。
    3. `PluginEditor` から定期的にメトリクスを取得し、GUI スレッドで可視化を更新。
    4. ユーザー操作 (カメラボタン / ズームスライダー / マウスドラッグ) は `SpeakerVisualizerComponent` 内で処理し、描画
パラメータに反映。

      - 9 個のカメラプリセットボタン (Home, Inside, Outside, Front, Back, Left, Right, Top, Bottom)
      - ズームスライダー (テキストボックス付き)
    - メインビュー


• Ran
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/basic_design.md' -Value @'
    # 基本設計書 (AtmosViz)

    ## 1. システム構成
    - ベースフレームワーク: JUCE 8.0.1
    - プロジェクト構成
      - "'`PluginProcessor` : オーディオ処理・解析を担当。
      - `PluginEditor`    : 3D 可視化 UI、カメラ制御、ユーザーインタラクション。
      - `docs/`           : 各種ドキュメント格納先。

    ## 2. データフロー
    1. DAW から 7.1.4 オーディオバッファを受け取る。
    2. `PluginProcessor::processBlock` で各チャンネルの RMS / Peak / FFT を計算し、最新メトリクスを共有メモリ
        (`latestMetrics`) に格納。
    3. `PluginEditor` から定期的にメトリクスを取得し、GUI スレッドで可視化を更新。
    4. ユーザー操作 (カメラボタン / ズームスライダー / マウスドラッグ) は `SpeakerVisualizerComponent` 内で処理し、描画
        パラメータに反映。

    ## 3. UI 構成
    - 上部コントロールバー
      - 9 個のカメラプリセットボタン (Home, Inside, Outside, Front, Back, Left, Right, Top, Bottom)
      - ズームスライダー (テキストボックス付き)
    - メインビュー
      - ルームワイヤーフレーム
      - スピーカー球体・指向性ローブ
      - XYZ ギズモ

    ## 4. カメラ設計
    - カメラプリセットは `CameraParameters` で yaw/pitch/inside/距離を定義。
    - Inside: カメラ位置は固定 (原点視点から回転のみ)。
    - Outside: 距離パラメータを直接利用し、広範囲を俯瞰。
    - マウスホイール・ズームスライダーは共通ズーム値を更新し、Inside/Outside で距離を再マッピング。

    ## 5. スピーカー可視化
    - Dolby 推奨角度・高さを `SpeakerDefinitions` として定義。
    - スピーカーごとに `SpeakerMetrics` (rms, peak, frequency bands) を保持。
    - ローブは RMS 値に応じて長さ (main) と広がり (spread) を変化させ、色は低/中/高帯域の比率でグラデーション。

    ## 6. 今後の拡張に備えたポイント
    - `CameraPreset` の列挙を追加するだけで新しい視点を増やせる構造。
    - ズーム・距離マッピングは共通関数化しており、レンジ調整が容易。
    - `latestMetrics` は固定サイズ配列のため、7.1.4 以外のレイアウト対応時は再生成の必要あり。
    '"'@"

• Proposed Command
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/detailed_design.md' -Value @'
    # 詳細設計書 (AtmosViz)

    ## 1. クラス構成

    ### 1.1 "'`AtmosVizAudioProcessor`
    - **役割**: オーディオ解析、メトリクス共有。
    - **主要メンバー**
      - `latestMetrics`: `std::array<SpeakerMetrics, 12>`
      - `metricsLock`: `juce::SpinLock`
      - FFT 関連: `juce::dsp::FFT`, `juce::dsp::WindowingFunction`
    - **主要メソッド**
      - `processBlock`: RMS/Peak/FFT 計算。
      - `copyLatestMetrics`: GUI ツールからの参照用コピー。
      - `buildSpeakerDefinitions`: Dolby 7.1.4 角度・高さを定義。

    ### 1.2 `SpeakerVisualizerComponent`
    - **役割**: 3D 描画、カメラ制御。
    - **主要プロパティ**
      - `CameraPreset enum` / `CameraParameters`
      - `zoomFactor`, `cameraDistance`, `cameraInside`
      - `speakers`: 可視化対象スピーカー配列
      - `roomVerticesModel`: ルームワイヤーフレームの 8 頂点
    - **主要メソッド**
      - `setCameraPreset`: yaw/pitch/distance を反映。
      - `setZoomFactor`: Inside/Outside 用に距離をリマップ。
      - `mouseDrag`: カメラの yaw/pitch を更新。
      - `mouseWheelMove`: ズーム値を更新。
      - `paint`: ワイヤーフレーム、スピーカー、ローブ、ギズモを描画。
      - 補助関数: `projectPoint`, `applyOrbit`, `drawRoom`, `drawGizmo`。

    ### 1.3 `AtmosVizAudioProcessorEditor`
    - **役割**: プリセットボタンとズームスライダーの管理。
    - **主要メソッド**
      - `createCameraButtons`: ボタン生成と `onClick` ハンドラ設定。
      - `setupZoomSlider`: 範囲/ツールチップ設定。
      - `sliderValueChanged`: ズーム値更新。
      - `setCameraPreset`: GUI 側から視点切り替え。
    - `projectPoint`: カメラ yaw/pitch に基づく手書きの投影計算。`cameraDistance` を透視投影距離として使用。
    - ローブ描画: `juce::Path` を用いて三角形 + 外周ストロークを描画。
    - ワイヤーフレーム: `roomEdges` の各辺を前面/背面に分類して線種を切り替える。


• Ran
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/detailed_design.md' -Value @'
    # 詳細設計書 (AtmosViz)

    ## 1. クラス構成

    ### 1.1 "'`AtmosVizAudioProcessor`
    - **役割**: オーディオ解析、メトリクス共有。
    - **主要メンバー**
      - `latestMetrics`: `std::array<SpeakerMetrics, 12>`
      - `metricsLock`: `juce::SpinLock`
      - FFT 関連: `juce::dsp::FFT`, `juce::dsp::WindowingFunction`
    - **主要メソッド**
      - `processBlock`: RMS/Peak/FFT 計算。
      - `copyLatestMetrics`: GUI ツールからの参照用コピー。
      - `buildSpeakerDefinitions`: Dolby 7.1.4 角度・高さを定義。

    ### 1.2 `SpeakerVisualizerComponent`
    - **役割**: 3D 描画、カメラ制御。
    - **主要プロパティ**
      - `CameraPreset enum` / `CameraParameters`
      - `zoomFactor`, `cameraDistance`, `cameraInside`
      - `speakers`: 可視化対象スピーカー配列
      - `roomVerticesModel`: ルームワイヤーフレームの 8 頂点
    - **主要メソッド**
      - `setCameraPreset`: yaw/pitch/distance を反映。
      - `setZoomFactor`: Inside/Outside 用に距離をリマップ。
      - `mouseDrag`: カメラの yaw/pitch を更新。
      - `mouseWheelMove`: ズーム値を更新。
      - `paint`: ワイヤーフレーム、スピーカー、ローブ、ギズモを描画。
      - 補助関数: `projectPoint`, `applyOrbit`, `drawRoom`, `drawGizmo`。

    ### 1.3 `AtmosVizAudioProcessorEditor`
    - **役割**: プリセットボタンとズームスライダーの管理。
    - **主要メソッド**
      - `createCameraButtons`: ボタン生成と `onClick` ハンドラ設定。
      - `setupZoomSlider`: 範囲/ツールチップ設定。
      - `sliderValueChanged`: ズーム値更新。
      - `setCameraPreset`: GUI 側から視点切り替え。

    ## 2. 描画計算
    - `projectPoint`: カメラ yaw/pitch に基づく手書きの投影計算。`cameraDistance` を透視投影距離として使用。
    - ローブ描画: `juce::Path` を用いて三角形 + 外周ストロークを描画。
    - ワイヤーフレーム: `roomEdges` の各辺を前面/背面に分類して線種を切り替える。

    ## 3. カメラ制御
    - プリセットは `presetMap` で一元管理。外部ビューでは距離をそのまま使用、Inside では距離を固定しズーム値のみ変更。
    - ズーム値が変化した際に `cameraDistance` を再計算することで、Inside は近づき、Outside は遠ざかる挙動を統一。
    - `mouseDrag`: yawAnchor / pitchAnchor と `e.position` の差から角度を更新。

    ## 4. メトリクス共有と描画同期
    - Audio スレッド → GUI スレッド間は `copyLatestMetrics` と `metricsLock` でスレッドセーフに共有。
    - GUI 側は `timerCallback` で 1/30 秒毎に最新メトリクスを取得し、滑らかに更新。

    ## 5. インタラクション
    - プリセットボタン: `TextButton` のクリックで `setCameraPreset` を呼び、ズームも同期。
    - ズームスライダー: Inside/Outside 共通のズーム値に対応し、マウスホイール操作とも連携。
    - マウスドラッグ: Inside/Outside どちらでも回転操作を提供。Inside は視点が原点に固定される。

    ## 6. 拡張ポイント
    - `presetMap` に項目を追加すれば新しい視点を容易に追加可能。
    - ズームのリマッピング式を `setZoomFactor` 内で集中管理しているため、レンジ変更や距離関数を簡単に調整できる。
    - `colourForBands` をカスタマイズすることで帯域ごとの色味を変更できる。
    '"'@"

• Proposed Command
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/user_manual.md' -Value @'
    # ユーザーズマニュアル (AtmosViz)

    ## 1. セットアップ
    1. Visual Studio 2022 でソリューションを開き、"'`Build > Clean Solution` → `Build Solution` を実行。
    2. 生成物 `Builds/VisualStudio2022/x64/Debug/VST3/AtmosViz.vst3/Contents/x86_64-win/AtmosViz.vst3` を
`%COMMONPROGRAMFILES%'"\\VST3"'` にコピー。
    3. DAW (VST3 対応) を起動し、AtmosViz をスキャンして挿入。

    ## 2. 基本操作
    - **Home ボタン**: Dolby 規定のリスニングポジションから正面を向く初期視点に戻ります。
    - **Inside**: 原点 (リスニング位置) に固定されたカメラで、ドラッグで上下左右を見渡します。
    - **Outside**: 部屋全体を俯瞰する遠距離視点。ズームを小さくするとさらに引きの映像になります。
    - **Front/Back/Left/Right/Top/Bottom**: Home を基準にそれぞれの方向へ振り向いたプリセット視点。
    - **ズームスライダー**: 数値が大きいほど近づき、数値が小さいほど遠ざかります。マウスホイールでも同様に操作可能。

    ## 3. 表示要素
    - **スピーカー球 / 指向性ローブ**: RMS レベルに応じてサイズと色が変化します。ローブは低・中・高帯域のバランスで色付
けされます。
    - **LFE**: 球のみ表示。
    - **ルームワイヤーフレーム**: Inside では全実線、Outside では奥行き表現のため背面のみ破線。
    - **XYZ ギズモ**: 画面中央に X (赤) / Y (緑) / Z (青) 軸を表示し、空間の向きを把握しやすくします。

    ## 4. 操作のヒント
    - マウスドラッグで視点を回転し、ホイールで距離を微調整すると音の広がりを直感的に確認できます。
    - Outside で極端に引く (ズーム ≒ 0.001) と、部屋全体が小さく表示され、各スピーカーの相対位置や指向性が俯瞰しやすくな
ります。
    - Inside でズームを大きくすると、リスニング位置付近での音量バランスや指向性を細かく観察できます。

    ## 5. トラブルシューティング
    - **プラグインが見つからない**: `%COMMONPROGRAMFILES%'"\\VST3"'` フォルダに `.vst3` をコピーしたか確認し、DAW のプラ
グインスキャンを再実行してください。
    - **視点が異常**: Home ボタンを押して初期状態にリセットしてください。
    - **ズームが効かない**: スライダーが 0.001〜2.0 の範囲にあるかを確認し、ホイール操作と併用してください。

    ## 6. 今後の改善予定
    - カラーテーマの切り替え、ローブ表現のカスタマイズ、ユーザー設定の保存などを今後検討しています。
    '"'@"

✔ You approved codex to run pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/user_manual.md' -Va... every time
this session

• Ran
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/user_manual.md' -Value @'
    # ユーザーズマニュアル (AtmosViz)

    ## 1. セットアップ
    1. Visual Studio 2022 でソリューションを開き、"'`Build > Clean Solution` → `Build Solution` を実行。
    2. 生成物 `Builds/VisualStudio2022/x64/Debug/VST3/AtmosViz.vst3/Contents/x86_64-win/AtmosViz.vst3` を
        `%COMMONPROGRAMFILES%'"\\VST3"'` にコピー。
    3. DAW (VST3 対応) を起動し、AtmosViz をスキャンして挿入。

    ## 2. 基本操作
    - **Home ボタン**: Dolby 規定のリスニングポジションから正面を向く初期視点に戻ります。
    - **Inside**: 原点 (リスニング位置) に固定されたカメラで、ドラッグで上下左右を見渡します。
    - **Outside**: 部屋全体を俯瞰する遠距離視点。ズームを小さくするとさらに引きの映像になります。
    - **Front/Back/Left/Right/Top/Bottom**: Home を基準にそれぞれの方向へ振り向いたプリセット視点。
    - **ズームスライダー**: 数値が大きいほど近づき、数値が小さいほど遠ざかります。マウスホイールでも同様に操作可能。
      - 範囲: 0.001 〜 2.0
      - Outside 選択時は自動で遠距離 (約 40 m) に設定されます。

    ## 3. 表示要素
    - **スピーカー球 / 指向性ローブ**: RMS レベルに応じてサイズと色が変化します。ローブは低・中・高帯域のバランスで色付
        けされます。
    - **LFE**: 球のみ表示。
    - **ルームワイヤーフレーム**: Inside では全実線、Outside では奥行き表現のため背面のみ破線。
    - **XYZ ギズモ**: 画面中央に X (赤) / Y (緑) / Z (青) 軸を表示し、空間の向きを把握しやすくします。

    ## 4. 操作のヒント
    - マウスドラッグで視点を回転し、ホイールで距離を微調整すると音の広がりを直感的に確認できます。
    - Outside で極端に引く (ズーム ≒ 0.001) と、部屋全体が小さく表示され、各スピーカーの相対位置や指向性が俯瞰しやすくな
        ります。
    - Inside でズームを大きくすると、リスニング位置付近での音量バランスや指向性を細かく観察できます。

    ## 5. トラブルシューティング
    - **プラグインが見つからない**: `%COMMONPROGRAMFILES%'"\\VST3"'` フォルダに `.vst3` をコピーしたか確認し、DAW のプラ
        グインスキャンを再実行してください。
    - **視点が異常**: Home ボタンを押して初期状態にリセットしてください。
    - **ズームが効かない**: スライダーが 0.001〜2.0 の範囲にあるかを確認し、ホイール操作と併用してください。

    ## 6. 今後の改善予定
    - カラーテーマの切り替え、ローブ表現のカスタマイズ、ユーザー設定の保存などを今後検討しています。
    '"'@"
    ディレクトリ名が無効です。 (os error 267)

• Proposed Command
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/user_manual.md' -Value @'
    # ユーザーズマニュアル (AtmosViz)

    ## 1. セットアップ
    1. Visual Studio 2022 でソリューションを開き、"'`Build > Clean Solution` → `Build Solution` を実行。
    2. 生成された `Builds/VisualStudio2022/x64/Debug/VST3/AtmosViz.vst3/Contents/x86_64-win/AtmosViz.vst3` を
`%COMMONPROGRAMFILES%'"\\VST3"'` にコピー。
    3. DAW (VST3 対応) を再スキャンして AtmosViz を挿入。

    ## 2. メイン操作
    - **カメラプリセットボタン**
      - *Home*: Dolby 規定リスニングポジションでセンター/L/R を正面に見る。
      - *Inside*: 原点を中心に回転のみ (距離固定)。
      - *Outside*: 部屋全体を俯瞰。初期距離は遠方。
      - 範囲: 0.001〜2.0 (値が大きいほど近づき、小さいほど遠ざかる)。
      - Outside 時はズームに応じて外部距離を直接調整。



• Ran
  └ pwsh -NoLogo -NoProfile -Command "Set-Content -Path 'docs/user_manual.md' -Value @'
    # ユーザーズマニュアル (AtmosViz)

    ## 1. セットアップ
    1. Visual Studio 2022 でソリューションを開き、"'`Build > Clean Solution` → `Build Solution` を実行。
    2. 生成された `Builds/VisualStudio2022/x64/Debug/VST3/AtmosViz.vst3/Contents/x86_64-win/AtmosViz.vst3` を
        `%COMMONPROGRAMFILES%'"\\VST3"'` にコピー。
    3. DAW (VST3 対応) を再スキャンして AtmosViz を挿入。

    ## 2. メイン操作
    - **カメラプリセットボタン**
      - *Home*: Dolby 規定リスニングポジションでセンター/L/R を正面に見る。
      - *Inside*: 原点を中心に回転のみ (距離固定)。
      - *Outside*: 部屋全体を俯瞰。初期距離は遠方。
      - *Front / Back / Left / Right / Top / Bottom*: Home を基準とした振り向き視点。
    - **ズームスライダー / マウスホイール**
      - 範囲: 0.001〜2.0 (値が大きいほど近づき、小さいほど遠ざかる)。
      - Outside 時はズームに応じて外部距離を直接調整。

    ## 3. 表示要素
    - スピーカー球と指向性ローブ (RMS・帯域比率に応じた色/サイズ)。
    - LFE は球のみ表示。
    - ルームワイヤーフレーム: Inside=実線、Outside=前面実線・背面破線。
    - XYZ ギズモで空間方向を明示。

    ## 4. 推奨ワークフロー
    1. Home で初期状態を確認。
    2. Inside で局所的な音量・指向性を観察。
    3. Outside でズームを 0.01 以下に下げ、全体のバランスと干渉を俯瞰。
    4. Front/Back/Left/Right で個別スピーカーのローブを比較。

    ## 5. トラブルシューティング
    - プラグインが表示されない場合は VST3 の配置と DAW の再スキャンを確認。
    - 視点が迷子になったら Home を押してリセット。
    - ズームが効かない場合はスライダー値が範囲内か、マウスホイールが DAW 側に奪われていないかを確認。

    ## 6. 今後の予定
    - 設定の保存/読込機能、配色テーマ切り替え、ローブ形状のカスタマイズなどを検討中。
    '"'@"

> ドキュメントを docs/ 以下に作成しました。次回セッションではこれらを参考に作業を再開できます。

  - docs/requirements.md …… 要求仕様書（本日の仕様を整理）
  - docs/basic_design.md …… 基本設計書（構成・データフロー）
  - docs/detailed_design.md …… 詳細設計書（クラス・メソッド詳細）
  - docs/user_manual.md …… ユーザーズマニュアル（操作手順とヒント）

  ### 次回再開手順（メモ）

  1. Visual Studio でソリューションを開き、Build > Clean Solution → Build Solution。
  2. 生成物 Builds/VisualStudio2022/x64/Debug/VST3/AtmosViz.vst3/Contents/x86_64-win/AtmosViz.vst3 を
  %COMMONPROGRAMFILES%\VST3 にコピーし、DAW で再スキャン。
  3. 仕様・設計・マニュアルは docs/ を参照。

  お疲れさまでした。また続きが必要になったらいつでも声をかけてください。
